# 修复API路径问题计划

## 问题分析

1. **API 404错误**: 前端向 `/api/products/{id}/details` 发送请求，但此路由在后端不存在
2. **API返回数据结构问题**: 前端期望获取商品详情来补充模板关联商品的数据，但后端API支持不完善

## 修复步骤

- [x] 1. 检查网络请求，确定错误所在
- [x] 2. 修改 `templateService.ts` 中的 `getTemplateDetails` 函数，避免请求不存在的API
   - [x] 删除 `/products/{id}/details` 相关请求
   - [x] 直接使用模板中已有的关联商品数据
   - [x] 为缺失字段提供默认值（如 stock_quantity, discount_percentage 等）
   
## 后续优化方向

1. **添加后端API支持**
   - 创建 `/api/products/{id}/details` 路由，返回商品完整信息
   - 确保返回的数据包含价格、库存等关键信息

2. **优化前端处理**
   - 添加更好的错误处理和后备机制
   - 为用户显示友好的错误提示
   - 允许即使部分数据缺失也能显示产品信息

3. **数据同步问题**
   - 建立系统确保模板的linked_products数据与实际产品数据保持同步
   - 可考虑实现缓存失效机制，确保价格变更时能及时更新

## 备注

- 当前修复是临时解决方案，不需要额外API请求即可保持页面正常工作
- 产品模板数据从 `/api/product-templates/{id}` 路由获取，此API正常工作
- 对于空价格或缺失字段，前端将使用默认值显示 