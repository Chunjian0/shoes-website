# 前后端连接计划

## 现状分析

前端和后端基本已经准备就绪：

1. 前端：
   - 端口：3000
   - 已有注册页面 `RegisterPage.tsx` 
   - 已有API服务 `api.ts`
   - 已有认证上下文 `AuthContext.tsx`
   - Vite代理配置已指向后端端口2268

2. 后端：
   - 端口：2268
   - 已有客户认证API
   - CORS配置已启用，并支持凭据
   - 验证码发送和验证功能已实现

## 连接步骤

### 1. 调整前端API基础URL和CSRF保护

需要确保前端请求包含CSRF令牌并使用正确的API端点：

1. 修改 `apiService` 中的 `baseURL` 确保使用正确的地址
2. 获取CSRF Cookie并在请求中附带CSRF令牌

### 2. 启动前端开发服务器

```bash
cd shoe-ecommerce-frontend
npm run dev
```

### 3. 测试CSRF Token获取

在注册流程开始前，确保获取到CSRF Token。

### 4. 测试验证码发送

验证前端表单能成功发送验证码请求到后端。

### 5. 测试注册流程

确保完整注册流程工作正常：
- 输入信息
- 发送验证码
- 验证邮箱
- 完成注册

## 潜在问题和解决方案

### 跨域问题

- **问题**: 浏览器可能阻止跨域请求
- **解决方案**: 确保CORS配置正确，`supports_credentials` 设置为 `true`

### CSRF令牌问题

- **问题**: 请求可能缺少CSRF令牌而被拒绝
- **解决方案**: 确保在发送请求前获取CSRF cookie，并在请求头中添加令牌

### 代理配置问题

- **问题**: 前端代理可能配置不正确
- **解决方案**: 确保Vite配置中的代理设置正确

## 测试计划

1. 使用控制台监控网络请求
2. 验证每个API调用的请求和响应
3. 确认验证码邮件能正确发送
4. 确认用户能成功注册并登录

## 总结

通过确保前端正确连接到后端API，我们能够完整实现用户注册流程。关键是要确保CSRF保护工作正常，并且前端能够正确地发送API请求到后端。 